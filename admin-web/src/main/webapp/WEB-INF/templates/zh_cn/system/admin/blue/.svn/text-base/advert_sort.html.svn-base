<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="$!webPath/resources/style/system/manage/$!{config.websiteCss}/template.css" rel="stylesheet" type="text/css" />
<script src="$!webPath/resources/js/jquery-1.6.2.js"></script>
<script src="$!webPath/resources/js/jquery.shop.common.js"></script>
<script>
function saveSort(){
	var patt=new RegExp("^[0-9]*$");
	var idVal = "";
	var myArray=new Array();
	var i = 0
	var hadError = false;
	jQuery("input[name='adSlideSequence']").each(function(element) {
		if(!this.value) {
			alert("温馨提示：序号不能为空");
			hadError = true;
			return false;
		}else{
			if(!patt.test(this.value)) {
				alert("温馨提示：只能输入数字");
				hadError = true;
				return false;
			}
			if(this.value < 0) {
				alert("温馨提示：请输入大于0的数字");
				hadError = true;
				return false;
			}
						
			myArray[i] = this.value;
			i++;
			
			idVal += this.id+","+this.value+";"
		}		
	});
	if(hadError)
		return false;
	
	var sortArr = myArray.sort();
	for(var j=0; j<sortArr.length-1; j++) {
		if(sortArr[j] == sortArr[j+1]) {
			alert("温馨提示：序号不能相同，请重输入");
			return false;
		}
	}
	jQuery("#idVals").val(idVal);
	jQuery("#ListForm").submit();
}
</script>
</head>
<body>
	<div class="cont">
		<h3 class="seth">广告管理</h3>
		<div class="nav_list">
			<ul>
				<li><a href="$!webPath/admin/advert_list.htm"><b>所有广告</b></a></li>
				#if(${sec.anyGranted("ROLE_ADVERT_ADMIN_CHECK")})
				<li><a href="$!webPath/admin/advert_list_audit.htm"><b>未审核广告</b></a></li>
				#end
				<li><a href="$!webPath/admin/advert_add.htm"  ><b>新增广告</b></a></li>
				<li><a href="$!webPath/admin/adv_pos_list.htm"><b>所有广告位</b></a></li>
				<li><a href="$!webPath/admin/adv_pos_add.htm"><b>新增广告位</b></a></li>
				#if($!sort)
				<li><a href="javascript:void(0);" class="this"><b>广告排序</b></a></li>
				#end
			</ul>
		</div>
		<form method="post" id="ListForm" action="$!webPath/admin/advert_sort_save.htm">
		<input type="hidden" id="idVals" name="idVals" value=""/>
			<div class="operation">
				<h3>友情提示</h3>
				<ul>
					<li>广告排序按照序号升序排列，即数字越大排在越后面。</li>
					<li>广告显示在客户端只显示前5条。</li>
				</ul>
			</div>
			<div class="fshoptb">
				<table width="100%" border="0" cellspacing="0" cellpadding="0"
					class="fshop_table">
					<tr>
						<th width="70%"><span class="form_btna">广告名称</span></th>
						<th width="30%"><span class="form_btna">广告序号</span></th>
					</tr>
					#foreach($obj in $objs)
					<tr>
						<td align="center">$!obj.adTitle</td>
						<td align="center"><input id="$!obj.id" name="adSlideSequence" type="text" value="$!obj.adSlideSequence" /></td>
					</tr>
					#end
				</table>
			</div>
			#if($!objs && $objs.size()>1)
			<center style="margin-top: 4px; margin-bottom: 4px;">
				<input name="" onclick="saveSort()" type="button" value="保存" style="cursor: pointer;" class="search_btn" />
			</center>
			#end
			<div class="operate_bar"></div>
		</form>
	</div>
</body>
</html>
