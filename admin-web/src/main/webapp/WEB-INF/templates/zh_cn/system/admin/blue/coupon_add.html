<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>
<link href="$!webPath/resources/style/system/manage/$!{config.websiteCss}/template.css"  rel="stylesheet" type="text/css"/>
<link  href="$!webPath/resources/style/common/css/jquery-ui-1.8.22.custom.css" type="text/css" rel="stylesheet">
<script src="$!webPath/resources/js/jquery-1.6.2.js"></script>
<script src="$!webPath/resources/js/jquery.validate.min.js"></script>
<script src="$!webPath/resources/js/jquery.shop.common.js"></script>
<script src="$!webPath/resources/js/jquery.poshytip.min.js"></script>
<script src="$!webPath/resources/js/jquery-ui-1.8.21.js"></script>
<script src="$!webPath/resources/js/jquery.zh.cn.js" charset="utf-8"></script>
<script src="$!webPath/resources/js/jquery.viewpic.js"></script>
<script>
jQuery(document).ready(function(){
	
	 jQuery("#logoShow").mouseover(function() {
	        jQuery("#logoImg").css('display', 'block');
	    }).mouseout(function() {
	        jQuery("#logoImg").css('display', 'none');
	    });
	
  jQuery.validator.methods.endTime = function(value, element, param) {
   var startDate = jQuery(param).val();
   var date1=new Date(Date.parse(startDate));
   var date2=new Date(Date.parse(value));
   if(jQuery.browser.msie==true){
      date1 = new Date(Date.parse(startDate.replace("-", "/")));
      date2 = new Date(Date.parse(value.replace("-", "/")));
   }
   return date1 < date2;
 };
 jQuery.validator.methods.beginTime = function(value, element, param) {
   var endDate = jQuery(param).val();
   var date1=new Date(Date.parse(endDate));
   var date2=new Date(Date.parse(value));
   if(jQuery.browser.msie==true){
      date1 = new Date(Date.parse(endDate.replace("-", "/")));
      date2 = new Date(Date.parse(value.replace("-", "/")));
   }
   return date1 > date2;
 };
  jQuery("#theForm").validate({
	errorPlacement: function(error, element) {  
       error.appendTo(element.parent());  
    },						  
    rules:{
	   couponName:{required:true},	
	   couponBeginTime:{required:true},
	   couponEndTime:{required:true,endTime:"#couponBeginTime"},
	   couponCount:{required:true,digits:true},
	   couponAmount:{required:true,digits:true,min:0},
	   couponOrderAmount:{required:true,digits:true,min:0}
	 },
    messages:{
     couponName:{required:"优惠券名称不能为空"},		
	 couponBeginTime:{required:"开始时间不能为空"},
	 couponEndTime:{required:"结束时间不能为空",endTime:"结束日期必须大于开始日期"},
	 couponCount:{required:"优惠券数量不能为空",digits:"优惠券只能为整数"},
	 couponAmount:{required:"优惠券金额不能为空",digits:"优惠券金额只能为整数",min:"优惠券金额必须大于0"},
	 couponOrderAmount:{required:"可使用订单金额不能为空",digits:"可使用订单金额只能为整数",min:"可使用订单金额必须大于0"}
	}
  });
 	//改变系统提示的样式
  jQuery("span .w").mousemove(function(){
	var id=jQuery(this.parentNode).attr("id");
	if(id="nothis"){
	   jQuery(this.parentNode).attr("id","this")
	}
  }).mouseout(function(){
     var id=jQuery(this.parentNode).attr("id");
	 if(id="this"){
	   jQuery(this.parentNode).attr("id","nothis")
	 }
  });
  //
  jQuery('#couponBeginTime').attr("readonly","readonly").datepicker({
	  dateFormat:"yy-mm-dd",
	  changeMonth: true,
	  changeYear: true
  });
  jQuery('#couponEndTime').attr("readonly","readonly").datepicker({
	  dateFormat:"yy-mm-dd",
	  changeMonth: true,
	  changeYear: true
  });
  //
  jQuery("#coupon_show").mouseover(function(){
	jQuery("#coupon").css('display','block');
	});
	jQuery("#coupon_show").mouseout(function(){
		jQuery("#coupon").css('display','none');
	});
  //
    jQuery("input[type=file]").change(function(){
	   var id=jQuery(this).attr("id");
	   jQuery("#"+id+"_text").val(jQuery(this).val());
   })
  //
});

function saveForm(){
	jQuery("#theForm").submit();
}
</script>
</head>
<body>
<form action="$!webPath/admin/coupon_save.htm" method="post" enctype="multipart/form-data" name="theForm" id="theForm">
  <div class="cont">
    <h1 class="seth">新增优惠券</h1>
    <div class="nav_list">
   <ul>
  
	<li><a href="$!webPath/admin/coupon_list.htm"><b>所有优惠券</b></a></li>
    <li><a href="$!webPath/admin/coupon_add.htm" class="this" ><b>新增优惠券</b></a></li>
   
   </ul>
    </div>
    <div class="edit">
    <div class="editul setcont" id="base">
      <ul class="set1">
        <li class="setcont_bg"><strong class="sred">*</strong>优惠券名称
          <input name="id" type="hidden" id="id" value="$!obj.id" />
        </li>
        <li><span class="webname">
          <input name="couponName" type="text" id="couponName" value="$!obj.couponName" />
          </span></li>
      </ul>
      <ul class="set1">
        <li class="setcont_bg"><strong class="sred">*</strong>开始时间</li>
        <li> <span class="webname">
          <input name="couponBeginTime" type="text" id="couponBeginTime" value="$!obj.couponBeginTime" size="25" />
        </span></li>
      </ul>
      <ul class="set1">
        <li class="setcont_bg"><strong class="sred">*</strong>结束时间</li>
        <li> <span class="webname">
          <input name="couponEndTime" type="text" id="couponEndTime" value="$!obj.couponEndTime" size="25" />
        </span></li>
      </ul>
      <ul class="set1">
        <li class="setcont_bg"><strong class="sred">*</strong>优惠券数量</li>
        <li> <span class="size70">
          <input name="couponCount" type="text" id="couponCount" value="$!obj.couponCount" />
        </span><span id="nothis"><strong class="q"></strong><strong class="w">数量为0时表示不限制数量</strong><strong class="c"></strong></span></li>
      </ul>
      <!-- <ul class="set1">
        <li class="setcont_bg" style="height:35px;">优惠券模板</li>
        <li> 
		<span class="webname"> 
		  <span class="eidt_li_a" style="position:relative; width:50px; height:22px; line-height:22px;margin-top: 3px; color:#333; border:1px solid #ccc; padding:2px 5px; border-radius:3px;">选择图片
		    <input type="file" id="advertImg" onchange="changePic('advertImg')" style="opacity: 0;top:0;left:1px;position:absolute; z-index:100;width:60px; " name="advertImg" />
		  </span> 
		</span>
		<span class="preview"> 
			<img src="$!webPath/resources/style/system/manage/blue/images/preview.jpg" width="25" height="25"  id="logoShow" style="cursor:help"/> 
		</span>
		#if($!exp.headImgPath)
		#set($img=$!imageTools.queryImg($!exp.headImgPath))
		<div class="bigimgpre" id="logoImg" style="display:none; left:270px;"><img src="$!exp.headImgPath"  width="200" height="200" id="advertImg"/> </div>
		#end
		<div class="pic-view"><img id="preview" alt="" name="pic" /></div>
        </li>
      </ul> -->
      <ul class="set1">
        <li class="setcont_bg"><strong class="sred">*</strong>优惠券金额</li>
        <li> <span class="webname">
          <input name="couponAmount" type="text" id="couponAmount" value="$!obj.couponAmount" />
        </span></li>
      </ul>
      <ul class="set1">
        <li class="setcont_bg"><strong class="sred">*</strong>可使用订单金额</li>
        <li> <span class="webname">
          <input name="couponOrderAmount" type="text" id="couponOrderAmount" value="$!obj.couponOrderAmount" />
        </span><span id="nothis"><strong class="q"></strong><strong class="w">订单金额达到该数值才可使用此优惠券</strong><strong class="c"></strong></span></li>
      </ul>
    </div>
    </div>
    <div class="submit">
  <span class="pad120">  <input name="" type="button" value="保存" style="cursor:pointer;" onclick="saveForm();"/></span>
  </div>
  </div>
  
</form>
</body>
</html>
