<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>
<link href="$!webPath/resources/style/system/manage/$!{config.websiteCss}/template.css"  rel="stylesheet" type="text/css"/>
<link  href="$!webPath/resources/style/common/css/jquery-ui-1.8.22.custom.css" type=text/css rel=stylesheet />
<script src="$!webPath/resources/js/jquery-1.6.2.js"></script>
<script src="$!webPath/resources/js/jquery.validate.min.js"></script>
<script src="$!webPath/resources/js/jquery.shop.common.js"></script>
<!-- <script src="$!webPath/resources/js/jquery.poshytip.min.js"></script> -->
<script src="$!webPath/resources/js/jquery-ui-1.8.21.js"></script>
<script src="$!webPath/resources/js/jquery.zh.cn.js" charset="utf-8"></script>
<script>
jQuery(document).ready(function(){
// 	jQuery("#orderStatus").val("$!vo.ord erStatus");
	
	jQuery('#arrivalDate').datepicker({
	  dateFormat:"yy-mm-dd",
	  changeMonth: true,
	  changeYear: true
  	});
  	jQuery('#departureDate').datepicker({
	  dateFormat:"yy-mm-dd",
	  changeMonth: true,
	  changeYear: true
  	});
  	jQuery('#creatBeginTimeStr').datepicker({
  	  dateFormat:"yy-mm-dd",
  	  changeMonth: true,
  	  changeYear: true
    	});
    jQuery('#creatEndTimeStr').datepicker({
  	  dateFormat:"yy-mm-dd",
  	  changeMonth: true,
  	  changeYear: true
    });
});

// function export_excel(){
// 	/* var orderStatus = $('#orderStatus').val();
// 	var orderId = $('#orderId').val();
// 	var storeName = $('#storeName').val();
// 	var userNickname = $('#userNickname').val();
	
// 	window.location.href="$!webPath/admin/order_list_export_excel.htm?orderStatus="
// 			+orderStatus+"&orderId="+orderId+"&storeName="+storeName+"&userNickname="+userNickname; */
// }

//导出报表
function export_excel(){
	
	
		var orderStatus = $("#orderStatus").val();
		var orderId = $("#orderId").val();
		var hotelName = $("#hotelName").val();
		var mobile = $("#mobile").val();
		var name = $("#name").val();
		var arrDate = $("#arrivalDate").val();
		var depaDate = $("#departureDate").val();
		var creatBeginTimeStr = $("#creatBeginTimeStr").val();
		var creatEndTimeStr = $("#creatEndTimeStr").val();
		if(!checkFilter()){
			alert("请选择导出条件！");
			return;
		}else{
			#if($!objs.size()>0)
				window.location.href="$!webPath/admin/hotel_order_export.htm?showStatus="+orderStatus
				+"&orderId="+orderId+"&hotelName="+hotelName
					+"&mobile="+mobile+"&name="+name+"&arrDate="+arrDate+"&depaDate="+depaDate
						+"&beginTime="+creatBeginTimeStr+"&endTime="+creatEndTimeStr;	
			#else
				alert("当前没有可以导出的数据！");
			#end
		}
}

function checkFilter(){
	if($("#orderStatus").val()==""
		  & $("#orderId").val()==""
		 	 &$("#hotelName").val()==""
		  		&$("#mobile").val()==""
		 		  &$("#name").val()==""
		  			&$("#arrivalDate").val()==""
		 			  &$("#departureDate").val()==""
					    &$("#creatBeginTimeStr").val()==""
						  &$("#creatEndTimeStr").val()==""){
		return false;
	}else{
		return true;
	}
}

</script>
</head>
<body>

<div class="cont">
  <h3 class="seth">酒店服务订单</h3>

  <form action="$!webPath/admin/hotel_group_order_list.htm?orderType=3" method="post" id="queryForm" >
<!--     <input type="hidden" name="userId" id="userId" value="$!vo.userId" /> -->
  <div class="search">
    <ul>
      <li> 
	      <span>订单状态</span>
	      <span>
		      <select name="showStatus" id="orderStatus">
		          <option value="">所有订单</option>
		         #foreach($status in $statusList)
		         	<option value="$status.statusId" #if($status.statusId == $vo.showStatus)selected="selected" #end>$!status.showStatus</option>
		         #end
		        </select>
	      </span>
	      <span>订单号</span>
	      <span class="size150">
	      	<input name="orderId" type="text" value="$!vo.orderId" id="orderId" />
	      </span>
	      <span>酒店名称</span>
	      <span class="size150">
	      	<input name="hotelName" type="text" value="$!vo.hotelName" id="hotelName" />
	      </span> 
	      <span>手机号</span>
	      <span class="size150">
	      	<input name="mobile" type="text" value="$!vo.mobile" id="mobile" />
	      </span>
	      <span>姓名</span>
	      <span class="size150">
	      	<input name="name" type="text" value="$!vo.name" id="name" />
	      </span>
        </li>
        <li>
        
	      <span>入住时间</span>
          <span class="size150"> 
			<input name="arrDate" type="text" id="arrivalDate" value="$!vo.arrDate" readonly="readonly" />
		  </span>
		  <span>离开时间</span>
		  <span class="size150"> 
			<input name="depaDate" type="text" id="departureDate" value="$!vo.depaDate" readonly="readonly" />
		  </span>
		  
		  <span>创建订单时间</span>
          <span class="size150"> 
			<input name="beginTime" type="text" id="creatBeginTimeStr" value="$!vo.beginTime" readonly="readonly" />
		  </span>&nbsp;—
		  <span class="size150"> 
			<input name="endTime" type="text" id="creatEndTimeStr" value="$!vo.endTime" readonly="readonly" />
		  </span>
	      <span>
	      	<input name="" type="submit"  value="搜索" style="cursor:pointer;" class="search_btn"/>
	      	<input name="" type="button" value="导出Excel" style="cursor:pointer;" title="导出Excel" class="search_btn" onclick="export_excel();"/>
	      </span> 
      </li>
    </ul>
  </div> 
  </form>
  <form action="$!webPath/admin/hotel_group_order_list.htm?orderType=3" method="post" id="ListForm" >
    <div class="fshoptb">
    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="fshop_table">
      <tr>
        <th width="10%"><span class="form_btna">订单号</span></th>
        <th width="12%"><span class="form_btna">酒店名称</span></th>
        <th width="7%"><span class="form_btna">房型</span></th>
        <th width="8%"><span class="form_btna">姓名</span></th>
        <th width="10%"><span class="form_btna">手机号</span></th>
        <th width="8%"><span class="form_btna">金额</span></th>
        <th width="10%"><span class="form_btna">订单创建时间</span></th>
        <th width="10%"><span class="form_btna">入住时间</span></th>
        <th width="10%"><span class="form_btna">离开时间</span></th>
        <th width="4%"><span class="form_btna">天数/晚</span></th>
        <th width="20%"><span class="form_btna">状态</span></th>
      </tr>
      #foreach($obj in $objs)
      <tr> 	 
        <td align="center">$!obj.orderId</td>
        <td align="center">$!obj.hotelName</td>
        <td align="center">$!obj.roomTypeName</td>
        <td align="center">$!obj.name</td>
        <td align="center">$!obj.mobile</td>
        <td align="center">$!obj.totalPrice</td>
        <td align="center">$!CommUtil.formatLongDate($obj.createTime)</td>
        <td align="center">$!CommUtil.formatLongDate($obj.arrivalDate)</td>
        <td align="center">$!CommUtil.formatLongDate($obj.departureDate)</td>
         <td align="center">$!obj.dayCount</td>
          <td align="center">$!obj.showStatus</td>
      </tr>
     #end
    </table>
  </div>
  <div class="operate_bar">
    <div class="fenye">
    	<input type="hidden" name="currentPage" id="currentPage" value="$!currentPage" />
    	<input type="hidden" name="showStatus" id="showStatus" value="$!vo.showStatus" />
    	<input type="hidden" name="orderId" id="orderId" value="$!vo.orderId" />
    	<input type="hidden" name="hotelName" id="hotelName" value="$!vo.hotelName" />
    	<input type="hidden" name="mobile" id="mobile" value="$!vo.mobile" />
    	<input type="hidden" name="name" id="name" value="$!vo.name" />
    	<input type="hidden" name="arrDate" id="arrDate" value="$!vo.arrDate" />
    	<input type="hidden" name="depaDate" id="depaDate" value="$!vo.depaDate" />
    	<input type="hidden" name="beginTime" id="beginTime" value="$!vo.beginTime" />
    	<input type="hidden" name="endTime" id="endTime" value="$!vo.endTime" />
	 	<input name="mulitId" type="hidden" id="mulitId" />
      	$!gotoPageFormHTML
    </div>  
   </div>
  </form>
</div>
</body>
</html>
