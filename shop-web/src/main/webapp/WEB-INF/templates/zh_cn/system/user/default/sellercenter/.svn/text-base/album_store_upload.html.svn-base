<link href="$!webPath/resources/style/common/css/window.css" type="text/css" rel="stylesheet" />
<link href="$!webPath/resources/style/common/css/overlay_blue.css" type="text/css" rel="stylesheet" />
<script src="$!webPath/resources/js/ajaxUpload.js"></script>
     <script>
	  function ajaxFileUpload() {
		  if(document.getElementById('file1').value==""){
			  alert('请选择文件');
			  return;
		  }
		  var upload_album_id=jQuery("#upload_album_id").val();
          $.ajaxFileUpload(
              {
                  url: '$!webPath/seller/swf_album_upload.htm;jsessionid=$!jsessionid', //用于文件上传的服务器端请求地址
                  secureuri: false, //是否需要安全协议，一般设置为false
                  fileElementId: 'file1', //文件上传域的ID
                  data: {//加入的文本参数  
                      "album_id": upload_album_id,
                      "session_u_id" : "$!{session_u_id}"
                  }, 
                  dataType: 'text', //返回值类型 一般设置为json
                  success: function (data, status)  //服务器成功响应处理函数
                  {
                      alert("图片上传成功！");
                      location.href=location.href;
                  },
                  error: function (data, status, e)//服务器响应失败处理函数
                  {
                      alert(e);
                  }
              }
          )
          
          
          return false;
      }
  </script>
<!-- <script>
var swf_upload;
var already_upload=0;
var mark = 0; 
jQuery(document).ready(function(){	
	 var settings_object = {//定义参数配置对象
		upload_url : "$!webPath/seller/swf_album_upload.htm;jsessionid=$!jsessionid",
            flash_url : "$!webPath/resources/flash/swfupload.swf",
            file_post_name : "imgFile",
             post_params : {
              "session_u_id" : "$!{session_u_id}"
            },
            use_query_string : false,
            requeue_on_error : false,
            file_types : "$!imageSuffix",
            file_types_description: "相册图片",
            file_size_limit : "$!config.imageFilesize",
            file_upload_limit : 0,
            file_queue_limit : 0,
            debug : false,
            prevent_swf_caching : true,
            preserve_relative_urls : false,
            button_placeholder_id : "upload_imgs",
            button_image_url : "$!webPath/resources/style/common/images/upload.jpg",
            button_width : 160,
            button_height : 28,
            button_text : "<b></b> <span class='upload_text'>选择上传相册图片</span>",
            button_text_style : ".upload_text { color: #666666;font-size:12px;margin-left:40px; }",
            button_text_left_padding : 3,
            button_text_top_padding : 5,
            button_action : SWFUpload.BUTTON_ACTION.SELECT_FILES,
            button_disabled : false,
            button_cursor : SWFUpload.CURSOR.HAND,
            button_window_mode : SWFUpload.WINDOW_MODE.TRANSPARENT,
			file_dialog_start_handler:fileDialogStart,
			file_dialog_complete_handler:fileDialogComplete,
            upload_start_handler:upload_start_handler,
            upload_success_handler:uploadSuccess,
			upload_complete_handler:uploadComplete,
			file_queue_error_handler:fileQueueError
			
    };   
    swf_upload = new SWFUpload(settings_object);//实例化一个SWFUpload，传入参数配置对象
	function fileDialogStart(){

	}
	function fileQueueError(file){
		alert("上传图片不得超过$!{config.imageFilesize}KB");
	}
	function fileDialogComplete(numFilesSelected, numFilesQueued) {
       jQuery("#img_select_info").show();
	   jQuery("#img_desc_info").text("本次共选择"+numFilesQueued+"图片，"+this.getStats().files_queued+"张等待上传");
    }
	function upload_start_handler(){
	  jQuery("#upload_wait").show();
	}
	function uploadSuccess(file, serverData){//单个图片上传成功
	  var obj=eval("("+serverData+")");
	  var stats = this.getStats(); 
	  if(obj.url==""){
		 mark=-1;
	    alert("您的图片空间不足，请删除相册多余图片！");
	  }
	}
	function uploadComplete(file) {
	try {
		if (this.getStats().files_queued == 0) {
           jQuery("#upload_wait").hide();
		   if(mark==0){
			alert("成功上传"+(already_upload+1)+"张图片！");
			}
		   window.location.href="$!webPath/seller/album_store.htm";
		} else {	
		    already_upload=already_upload+1;
		    var count=this.getStats().files_queued;
			if(count<0)count=0;
			jQuery("#img_desc_info").text("正在上传第"+(already_upload+1)+"张,还剩下"+(count-1)+"张等待上传"); 
		    this.startUpload();
		}
	} catch (ex) {
		this.debug(ex);
	}
	}
});
function upload_img(){
  if(swf_upload.getStats().files_queued>0){
  var upload_album_id=jQuery("#upload_album_id").val();
  	swf_upload.addPostParam("album_id",upload_album_id); 
  	jQuery("#img_desc_info").text("正在上传第1张,还剩下"+(swf_upload.getStats().files_queued-1)+"张等待上传"); 
  	swf_upload.startUpload();
  }else{
	alert("没有可以上传的图片");
  }  
}
</script> -->
<form action="$!webPath/seller/album_store_save.htm" method="post" id="theForm">
<table style="float:left;" width="100%" border="0" cellspacing="0" cellpadding="0" class="box_table">
    <tr>
      <td width="120" align="right" class="hui_table"><input name="id" type="hidden" id="id" value="$!obj.id" />
      上传至：</td>
      <td align="left"><span class="dia_txt">
         <select name="upload_album_id" id="upload_album_id">
             #foreach($obj in $objs)
             <option value="$!obj.id">$!obj.albumName</option>
             #end
            </select>
      </span></td>
    </tr>
    <tr id="img_select_info" style="display:none;">
      <td align="right" class="hui_table">图片信息：</td>
      <td align="left"><span id="img_desc_info"></span></td>
    </tr>
    <tr>
      <td width="120" align="right" class="hui_table">选择图片：</td>
      <td align="left"><input type="file" id="file1" multiple="true" name="imgFile" /></td>
    </tr>
    <tr>
      <td width="120" align="right" class="hui_table"></td>
      <td align="left"><span style="font-size: 14px;color: red;">图片尺寸为800*576</span></td>
    </tr>
    <tr>
      <td colspan="2" align="center"><span class="inputbtn">
        <input type="button" value="上传" style="cursor:pointer;" onclick="ajaxFileUpload();"/>
        <img src="$!webPath/resources/style/common/images/wait.gif" style="display:none;" id="upload_wait" />
        <input name="currentPage" type="hidden" id="currentPage" value="$!currentPage" />
        </span></td>
    </tr>
  </table>
</form>
